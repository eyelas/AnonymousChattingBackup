(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1163:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1104),a=s(n(1450)),u=s(n(2215)),c=function(e){function t(n){var o=n.ws,r=n.fileGuid,s=n.currentUserId,i=n.colorPalette,a=n.sendClientStatus,c=e.call(this)||this;return c._collaborators=[],c.getCollaborators=function(){return c._collaborators},c._onMessage=function(e){var n;if(e)if("CONNECTED"===e.type)c._sendClientStatus("enter");else if("COLLABROOM"===e.type){var o=e.data;if(!(n=o)||"string"!=typeof n.type)return void c.emit(t.Events.Message,e);switch(o.type){case"RECONNECT_READY":c._collaborators.length=0,c._colorPalette.reset(),c._addCollaborators(o.clients);break;case"USER_ENTER":c._addCollaborators([o.userInfo]);break;case"USER_LEAVE":c._removeCollaborators([o.userInfo]);break;default:c._handleCollabRoomMessage(e)}}},c._socket=o,c._currentUserId=s,c._fileGuid=r,c._sendClientStatus=a||c._defaultSendClientStatus,c._colorPalette=new u.default(c._currentUserId,i),c}return r(t,e),t.prototype.userColor=function(e){return this._colorPalette.userColor(e)},t.prototype.setColorPalette=function(e){this._colorPalette.setColorPalette(e)},t.prototype.quit=function(){this._socket.off("message",this._onMessage),this._sendClientStatus("quit")},t.prototype.start=function(){this._socket.on("message",this._onMessage),this._sendClientStatus("enter")},t.prototype.sendUserSelectMessage=function(e){var t,n,o,r=(t=e,n={type:"SELECT"},o={},Object.keys(t).forEach((function(e){o[e]=t[e]})),Object.keys(n).forEach((function(e){o[e]=n[e]})),o),s={type:"COLLABROOM",padId:this._fileGuid,fileGuid:this._fileGuid,data:r};this._socket.emit("message",s)},t.prototype._addCollaborators=function(e){var n=this,o=[];e.forEach((function(e){e.id!==n._currentUserId&&(-1===l(n._collaborators,(function(t){return t.id===e.id}))&&(e.color=n.userColor(e.id),n._collaborators.push(e),o.push(e)))})),o.length>0&&this.emit(t.Events.UserEnter,{collaborators:this._collaborators,enterUsers:o})},t.prototype._removeCollaborators=function(e){var n=this,o=[];e.forEach((function(e){if(e.id!==n._currentUserId){var t=l(n._collaborators,(function(t){return t.id===e.id}));t>-1&&(o.push(e),n._collaborators.splice(t,1))}})),o.length>0&&this.emit(t.Events.UserLeave,{collaborators:this._collaborators,leaveUsers:o})},t.prototype._defaultSendClientStatus=function(e){var t={component:"pad",type:"enter"===e?"CLIENT_READY":"CLIENT_QUIT",padId:this._fileGuid,fileGuid:this._fileGuid,reconnect:!0,sessionID:a.default.get("sessionID"),token:a.default.get("token"),protocolVersion:2};this._socket.emit("message",t)},t.prototype._handleCollabRoomMessage=function(e){var n=function(e,t){if(!e||!e.data)return;if(!e.data.userInfo||""+e.data.userInfo.id==""+t)return;return e.data}(e,""+this._currentUserId);null!=n&&"SELECT"===n.type?this.emit(t.Events.UserSelect,n):this.emit(t.Events.Message,e)},t.ColorPalette=u.default,t.Events={UserEnter:"UserEnter",UserLeave:"UserLeave",UserSelect:"UserSelect",Message:"Message"},t}(i.EventEmitter);function l(e,t){for(var n=0,o=e.length;n<o;n++){if(t(e[n]))return n}return-1}t.default=c},1170:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s,i=n(1193),a=n(1533),u=n(1380),c=n(1533);t.Status=c.Status,function(e){e[e.ONLINE=0]="ONLINE",e[e.OFFLINE=1]="OFFLINE",e[e.FORCE_OFFLINE=2]="FORCE_OFFLINE"}(s||(s={}));var l=function(e){function t(t){var n=t.timeoutThreshold,o=t.online,r=void 0===o||o,i=e.call(this)||this;return i.events={CHANGE:"change"},i.beforeSendRequestTime=0,i.receivePending=!1,i.timeoutThreshold=n,i.online=r?s.ONLINE:s.OFFLINE,i.status=r?a.Status.ONLINE:a.Status.OFFLINE,setTimeout((function(){i.status===a.Status.OFFLINE&&i.emitChange(i.status)}),0),i}return r(t,e),t.prototype.onEvent=function(e){for(var t=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e){case i.Event.ACCEPT:this.online!==s.ONLINE&&(this.emitChange(a.Status.ONLINE),this.online=s.ONLINE),this.receivePending=!1,this.beforeSendRequestTime=0,clearTimeout(this.saveTimeout),this.emitChange(a.Status.ONLINE_SAVED);break;case i.Event.ERROR:case i.Event.ACCEPT_FAILED:this.emitChange(a.Status.ONLINE_SAVE_FAILED);break;case i.Event.NEW_CHANGE:this.online===s.ONLINE?this.emitChange(a.Status.ONLINE_SAVING):this.emitChange(a.Status.OFFLINE_SAVING);break;case i.Event.NEW_CHANGE_SAVE_TO_STORAGE_FAILED:this.online!==s.ONLINE&&this.emitChange(a.Status.OFFLINE_SAVE_FAILED);break;case i.Event.NEW_CHANGE_SAVED_TO_STORAGE:this.online!==s.ONLINE&&this.emitChange(a.Status.OFFLINE_SAVED);break;case i.Event.BEFORE_SEND_REQUEST:if(this.beforeSendRequestTime)return;this.beforeSendRequestTime=Date.now(),clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((function(){t.online=s.FORCE_OFFLINE,t.emitChange(a.Status.OFFLINE,{forceOffline:!0})}),this.timeoutThreshold);break;case i.Event.CHANGES_PENDING:if(this.receivePending)return;this.receivePending=!0,this.emitChange(a.Status.SERVER_CHANGE_PENDING),clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((function(){t.online=s.FORCE_OFFLINE,t.emitChange(a.Status.OFFLINE,{forceOffline:!0})}),3*this.timeoutThreshold);break;case i.Event.SERVER_CHANGE_APPLIED:this.receivePending?this.saveStatus(a.Status.SERVER_CHANGE_APPLIED):this.emitChange(a.Status.SERVER_CHANGE_APPLIED);break;case i.Event.WAITING_FOR_CAN_HANDLE_SERVER_CHANGES:clearTimeout(this.saveTimeout);break;case i.Event.NETWORK_CHANGE:var r=n[0];r&&this.online===s.OFFLINE&&(this.online=s.ONLINE,this.emitChange(a.Status.ONLINE)),r||this.online!==s.ONLINE||(this.online=s.OFFLINE,this.emitChange(a.Status.OFFLINE))}},t.prototype.destroy=function(){clearTimeout(this.saveTimeout)},t.prototype.saveStatus=function(e){this.track("saveStatus changed to "+e),this.status=e},t.prototype.emitChange=function(e,t){this.saveStatus(e),this.emit(this.events.CHANGE,e,t)},t.events={CHANGE:"change"},t}(u.Base);t.SaveStatus=l},1302:function(e,t,n){(function(o){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG),e}(t=e.exports=n(2214)).log=function(){return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var r=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(s=r))})),e.splice(s,0,o)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=s,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(s())}).call(this,n(92))},1380:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{u(o.next(e))}catch(e){s(e)}}function a(e){try{u(o.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(1104),c=n(1193),l=n(1302),f={},C=[].slice,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delayRunTimeouts={},t}return r(t,e),t.prototype.delayRun=function(e,t){var n=this,o=e.toString(),r=this.delayRunTimeouts[o],s=C.call(arguments).slice(2);r&&clearTimeout(r),this.delayRunTimeouts[o]=setTimeout((function(){delete n.delayRunTimeouts[o],e.apply(n,s)}),t)},t.prototype.cancelDelayRun=function(e){var t=e.toString(),n=this.delayRunTimeouts[t];return!!n&&(clearTimeout(n),delete this.delayRunTimeouts[t],!0)},t.prototype.assert=function(e,t){if(!e)throw new c.CollaborationError("Assertion error",c.ERROR.ERR_ASSERTION,t)},t.prototype.superDestroy=function(){for(var e in this.delayRunTimeouts)this.delayRunTimeouts[e]&&clearTimeout(this.delayRunTimeouts[e])},t.prototype.wrapAsyncTryCatch=function(e,t){var n=this;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return i(n,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.apply(t,o)];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),this.emit(c.Event.ERROR,new c.CollaborationError("Try catch wrapper invoke error",c.ERROR.ERR_FN_INVOKE,n)),[3,3];case 3:return[2]}}))}))}},t.prototype.track=function(e,t){void 0===t&&(t={});var n=this.constructor.name;(f[n]||(f[n]=l("collab:"+n)))(e,t);var o={module:n,message:e};t instanceof Error&&(t=s(s({},t),{message:t.message,stack:t.stack})),o.data=t,this.emit(c.Event.TRACK,o)},t}(u.EventEmitter);t.Base=h},1533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OFFLINE="offline",e.OFFLINE_SAVING="offlineSaving",e.OFFLINE_SAVED="offlineSaved",e.OFFLINE_SAVE_FAILED="offlineSaveFailed",e.ONLINE="online",e.ONLINE_SAVING="onlineSaving",e.ONLINE_SAVED="onlineSaved",e.ONLINE_SAVE_FAILED="onlineSaveFailed",e.SERVER_CHANGE_APPLIED="serverChangeApplied",e.SERVER_CHANGE_PENDING="serverChangePending"}(t.Status||(t.Status={}))},2214:function(e,t,n){function o(e){var n;function o(){if(o.enabled){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,o){if("%%"===n)return n;u++;var r=t.formatters[o];if("function"==typeof r){var s=i[u];n=r.call(e,s),i.splice(u,1),u--}return n})),t.formatArgs.call(e,i);var c=o.log||t.log||void 0;c.apply(e,i)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var n,o=0;for(n in e)o=(o<<5)-o+e.charCodeAt(n),o|=0;return t.colors[Math.abs(o)%t.colors.length]}(e),o.destroy=r,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function r(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var o=("string"==typeof e?e:"").split(/[\s,]+/),r=o.length;for(n=0;n<r;n++)o[n]&&("-"===(e=o[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,o;for(n=0,o=t.skips.length;n<o;n++)if(t.skips[n].test(e))return!1;for(n=0,o=t.names.length;n<o;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(1417),t.instances=[],t.names=[],t.skips=[],t.formatters={}},2215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=["#A69ACA","#EC6E79","#F39801","#00A496","#FFD900","#674599","#83D4E7","#AF7C4F","#B8D200","#9D5B8B","#F15B1C","#41464B","#CD9F00","#47885E","#D7003B","#436EC9","#F897C7","#9C4109","#6E7A56","#83D4E7","#83609C","#F8DCDB","#E7C39C","#87B151","#9E0038","#B09FC9","#7DCFC8","#BEE7F0","#CD9F00","#CBAAC2","#F5C5C9","#CD8C28","#1A5A52","#9EB4E1","#406619","#CAB738","#F6C751","#8D699D","#613A14","#189DEC"],r=function(){function e(e,t){var n,r=this;this._colorPalette=o,this._userColorMap={},this._currentUserId=e,t&&(this._colorPalette=t),this._getColor=(n=0,function(){var e=r._colorPalette,t=e[n];return(n+=1)>e.length&&(n=0),t})}return e.prototype.setColorPalette=function(e){this._colorPalette=e,this.reset()},e.prototype.userColor=function(e){if(this._isCurrentUser(e))return"#5292F7";var t=this._userColorMap[e];return null==t&&(t=this._getColor(),this._userColorMap[e]=t),t},e.prototype.reset=function(){this._userColorMap={}},e.prototype._isCurrentUser=function(e){return e+""==this._currentUserId+""},e}();t.default=r}}]);